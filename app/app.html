<head>
  <title>app</title>
</head>

<body>
  {{#if currentUser}}
    {{> Layout}}
  {{else}}
    {{> Login}}
  {{/if}}
</body>

<!-- LOGIN TEMPLATE -->
<template name="Login">
  <div class="login">
    <h3>Please sign in to start loitering.</h3>
    {{> loginButtons}}
  </div>
</template>

<!-- LAYOUT TEMPLATE -->
<template name="Layout">
  <div id="sideMenu">
    {{> SideMenu}}
  </div>

  <div id="loiterRooms">
    {{> LoiterRooms}}
  </div>
</template>

<!-- SIDEMENU TEMPLATE -->
<template name="SideMenu">
  Hi, {{> loginButtons}}

  <h2>Users</h2>

  {{#each users}}
    <div data-conversation-start class="username">
      {{this.profile.name}}
    </div>
  {{/each}}

  <h2>Current Loiterings</h2>

    {{#each conversations}}
      <div data-conversation>
        {{this.with}}
      </div>
    {{/each}}
</template>

<!-- LOITER ROOM TEMPLATE -->
<template name="LoiterRooms">
  <h2>Loitering with {{activeConvo}}</h2>
    <section>
      <div class="messages-with-{{activeConvo}}">
        <ul>
        {{#each messages}}
          <li>
            {{> MessageInfo}}
          </li>
        {{else}}
          <li>No messages yet.</li>
        {{/each}}
      </ul>
      </div>
      <!-- {{> MessageHistory}} -->
    </section>

    <footer>
      {{> SendMessage}}
    </footer>
</template>

<template name="MessageHistory">
</template>

<template name="MessageInfo">
  <div>
    <span><strong>{{login}} - {{prettyTimestamp timestamp}}</strong></span>
  </div>

  <div class="message">
    {{message}}
  </div>
</template>

<template name="SendMessage">
  <form>
    <input class="text" type="text" autofocus name="message" placeholder="Send a message" />
    <input class="text" type="hidden" name="convoWith" value={{activeConvo}} />
    <input class="send" type="submit" value="Send" />
  </form>
</template>